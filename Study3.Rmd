---
title: "Study 2"
author: "Elizabeth Huppert"
date: "5/4/2020"
output: pdf_document
---

#Set-up and Read in Data

You need to install the following packages to run this code:

-here
-tidyverse
-afex
-apa
-dplyr
-psych
-emmeans

```{r setup, include=FALSE}
library(here)
library(tidyverse)
library(afex)
library(apa)
library(dplyr)
library(psych)
library(emmeans)

#read in data

s2 <- read.csv(here("HypocrisyStudy2_cleaned.csv"))

```


Note: The current csv file imported for this analysis reflects cleaned data. 
The raw data and more information about the cleaning/coding of variables that went into making the current clean csv file is available in the Excel codebook. Additionally, more information is available upon request.


# Models

Key variable names (also see codebook for more information):

1. Proclamation:
Assignment to one of three conditions: "Lying is never [rarely/sometimes] okay" (absolute vs. ambitious vs. flexible)

2. Behavior:
Assignment to "prosocial.lie" vs. "selfish.truth"  

3. Behavlie:
prosocial lie = 1, selfish truth = 0

4. rv:
Decisions to RELY (1) or VERIFY (0) in the RV game

5. Sometimes:
Dummy-coded proclamation variable (sometimes = 1, rarely/never = 0)

6. Rarely:
Dummy-coded proclamation variable (rarley = 1, sometimes/never = 0)

7. Never:
Dummy-coded proclamation variable (never = 1, sometimes/rarely = 0)

Supplemental:

Pref = Attitudes towards honesty;1-5 statement
("Lying is always [often/sometimes/rarely/never] okay" = 1-5)

# Composite Evaluation Variables

Items with high agreement were combined as per our pre-registration.

```{r}
#Hypocrisy
hypocrisy2_check <- data.frame(s2$Hypocrisy_1, s2$Hypocrisy_2, s2$Hypocrisy_3, s2$Hypocrisy_4, s2$Hypocrisy_5)
summary(hypocrisy2_check)
describe(hypocrisy2_check)
psych::alpha(hypocrisy2_check) #alpha = 0.92
s2 <- mutate(s2, 
             Hypocrisy_composite2 = ((s2$Hypocrisy_1 + s2$Hypocrisy_2 + s2$Hypocrisy_3 + s2$Hypocrisy_4 + s2$Hypocrisy_5)/5))

#Morality  
moral2_check <- data.frame(s2$Moral_1, s2$Moral_2, s2$Moral_3)
summary(moral2_check)
describe(moral2_check)
psych::alpha(moral2_check) #alpha = .96
s2 <- mutate(s2, 
             Moral_composite2 = ((s2$Moral_1+s2$Moral_2+s2$Moral_3)/3))


#Future Honesty 
honest2_check <- data.frame(s2$Honest_frequency, s2$Honest_likely, s2$Honest_extreme, s2$Honest_committment)
summary(honest2_check)
describe(honest2_check)
psych::alpha(honest2_check) #alpha = 0.84
s2<- mutate(s2, 
            Honest_composite2 = ((s2$Honest_frequency + s2$Honest_likely + s2$Honest_extreme + s2$Honest_committment)/4))


```

Evaluation variables:

Hypocrisy_composite2 = hypocrisy composite of 5 items (Ratings: 1-7)
Moral_composite2 = morality composite of 3 items (Ratings: 1-7)
Honest_composite2 = future honesty composite of 4 items (Ratings: 1-7)

#Hypocrisy Model

```{r}
#ANOVA
hypocrisy_2.afex <-aov_car(Hypocrisy_composite2 ~ proclamation*behavior + Error(ID), data=s2)
summary(hypocrisy_2.afex) 
anova_apa(hypocrisy_2.afex)
```

#Hypocrisy Descriptives

```{r}
#Cells
tapply(s2$Hypocrisy_composite2, list(s2$proclamation, s2$behavior), mean)
tapply(s2$Hypocrisy_composite2, list(s2$proclamation, s2$behavior), sd)
tapply(s2$Hypocrisy_composite2, list(s2$proclamation, s2$behavior), length)

#Across Proclamation
tapply(s2$Hypocrisy_composite2, s2$proclamation, mean)
tapply(s2$Hypocrisy_composite2, s2$proclamation, sd)
tapply(s2$Hypocrisy_composite2, s2$proclamation, length)

#Across Behavior
tapply(s2$Hypocrisy_composite2, s2$behavior, mean)
tapply(s2$Hypocrisy_composite2, s2$behavior, sd)
tapply(s2$Hypocrisy_composite2, s2$behavior, length)

#Overall
mean(s2$Hypocrisy_composite2)
sd(s2$Hypocrisy_composite2)
length(s2$Hypocrisy_composite2)

```

#Hypocrisy Simple Effects - Subsetting Data

```{r}
#How does behavior vary by proclamation type?
#Subset for main effects tests

never_s2 <- s2 %>%
  filter(proclamation == "never") #192 - never

rarely_s2 <- s2 %>%
  filter(proclamation == "rarely") #202 - rarely

sometimes_s2 <- s2 %>%
  filter(proclamation == "sometimes") #204 - never

#Subset for one level of one factor 

never_exclude <- s2 %>%
  filter(proclamation != "never")  #406, rarely and sometimes

rarely_exclude <- s2 %>%
  filter(proclamation != "rarely") #396, never and sometimes

sometimes_exclude <- s2 %>%
  filter(proclamation != "sometimes") #394, never and rarely

#Selfish truth - rarely sometimes
never_truth <- never_exclude %>%
  filter(behavior == "selfish.truth") #197

#Prosocial lie - rarely sometimes
never_lie <- never_exclude %>%
  filter(behavior == "prosocial.lie") #209

#Selfish truth - never sometimes
rarely_truth <- rarely_exclude %>%
  filter(behavior == "selfish.truth") #194

#Prosocial lie- never sometimes
rarely_lie <- rarely_exclude %>%
  filter(behavior == "prosocial.lie") #202

#Selfish truth - never rarely
sometimes_truth <- sometimes_exclude %>%
  filter(behavior == "selfish.truth") #189

#Prosocial lie -never rarely
sometimes_lie <- sometimes_exclude %>%
  filter(behavior == "prosocial.lie") #205



```

#Hypocrisy Simple Effects - T-tests

```{r}
#T-tests
#Rarely vs. sometimes, selfish truth
t.test(Hypocrisy_composite2 ~ proclamation, never_truth, var.equal = TRUE)
t_apa(t.test(Hypocrisy_composite2 ~ proclamation, never_truth, var.equal = TRUE))

#Rarely vs. sometimes, prosocial lie
t.test(Hypocrisy_composite2 ~ proclamation, never_lie, var.equal = TRUE)
t_apa(t.test(Hypocrisy_composite2 ~ proclamation, never_lie, var.equal = TRUE))

#Never vs. sometimes, selfish truth
t.test(Hypocrisy_composite2 ~ proclamation, rarely_truth, var.equal = TRUE)
t_apa(t.test(Hypocrisy_composite2 ~ proclamation, rarely_truth, var.equal = TRUE))

#Never vs. sometimes, prosocial lie
t.test(Hypocrisy_composite2 ~ proclamation, rarely_lie, var.equal = TRUE)
t_apa(t.test(Hypocrisy_composite2 ~ proclamation, rarely_lie, var.equal = TRUE))

#Never vs. rarely, selfish truth
t.test(Hypocrisy_composite2 ~ proclamation, sometimes_truth, var.equal = TRUE)
t_apa(t.test(Hypocrisy_composite2 ~ proclamation, sometimes_truth, var.equal = TRUE))

#Never vs. rarely, prosocial lie
t.test(Hypocrisy_composite2 ~ proclamation, sometimes_lie, var.equal = TRUE)
t_apa(t.test(Hypocrisy_composite2 ~ proclamation, sometimes_lie, var.equal = TRUE))

#Alternative ANOVA and tukey post-hoc tests
hyp_model = aov_ez('ID', 'Hypocrisy_composite2', s2,
                    within = c (),
                    between = c ('proclamation', 'behavior'),
                    anova_table = list(es = 'pes'))
print(hyp_model)
means <- emmeans(hyp_model, ~ proclamation|behavior)
print(means)
post1 <- emmeans(hyp_model, ~ proclamation|behavior)
pairs(post1)     
```


#Morality Model

```{r}
#ANOVA
moral_2.afex <-aov_car(Moral_composite2 ~ proclamation*behavior + Error(ID), data=s2)
summary(moral_2.afex) 
anova_apa(moral_2.afex)
```


#Morality Descriptives

```{r}
#Cells
tapply(s2$Moral_composite2, list(s2$proclamation, s2$behavior), mean)
tapply(s2$Moral_composite2, list(s2$proclamation, s2$behavior), sd)
tapply(s2$Moral_composite2, list(s2$proclamation, s2$behavior), length)

#Across Proclamation
tapply(s2$Moral_composite2, s2$proclamation, mean)
tapply(s2$Moral_composite2, s2$proclamation, sd)
tapply(s2$Moral_composite2, s2$proclamation, length)

#Across Behavior
tapply(s2$Moral_composite2, s2$behavior, mean)
tapply(s2$Moral_composite2, s2$behavior, sd)
tapply(s2$Moral_composite2, s2$behavior, length)

#Overall
mean(s2$Moral_composite2)
sd(s2$Moral_composite2)
length(s2$Moral_composite2)

```

#Morality Simple Effects 

Note: For these tests, use subsetted data from Hypocrisy simple effects test (previous code chunk).


```{r}
#Main effect of proclamation
#Never vs. rarely only
t.test(Moral_composite2 ~ proclamation, sometimes_exclude, var.equal = TRUE)
t_apa(t.test(Moral_composite2 ~ proclamation, sometimes_exclude, var.equal = TRUE))

#Never vs. sometimes  only
t.test(Moral_composite2 ~ proclamation, rarely_exclude, var.equal = TRUE)
t_apa(t.test(Moral_composite2 ~ proclamation, rarely_exclude, var.equal = TRUE))

#Rarely  vs. sometimes  only
t.test(Moral_composite2 ~ proclamation, never_exclude, var.equal = TRUE)
t_apa(t.test(Moral_composite2 ~ proclamation, never_exclude, var.equal = TRUE))

#Alternative ANOVA and tukey post-hoc tests
mor_model = aov_ez('ID', 'Moral_composite2', s2,
                    within = c (),
                    between = c ('proclamation', 'behavior'),
                    anova_table = list(es = 'pes'))
print(mor_model)
means <- emmeans(mor_model, ~ proclamation|behavior)
print(means)
post1 <- emmeans(mor_model, ~ proclamation)
pairs(post1) 

```

#Future Honesty Model

```{r}
#ANOVA
honesty_2.afex <-aov_car(Honest_composite2 ~ proclamation*behavior + Error(ID), data=s2)
summary(honesty_2.afex)
anova_apa(honesty_2.afex)
```

#Future Honesty Descriptives

```{r}
#Cells
tapply(s2$Honest_composite2, list(s2$proclamation, s2$behavior), mean)
tapply(s2$Honest_composite2, list(s2$proclamation, s2$behavior), sd)
tapply(s2$Honest_composite2, list(s2$proclamation, s2$behavior), length)

#Across Proclamation
tapply(s2$Honest_composite2, s2$proclamation, mean)
tapply(s2$Honest_composite2, s2$proclamation, sd)
tapply(s2$Honest_composite2, s2$proclamation, length)

#Across Behavior
tapply(s2$Honest_composite2, s2$behavior, mean)
tapply(s2$Honest_composite2, s2$behavior, sd)
tapply(s2$Honest_composite2, s2$behavior, length)

#Overall
mean(s2$Honest_composite2)
sd(s2$Honest_composite2)
length(s2$Honest_composite2)


```

#Future Honesty Simple Effects - T-tests

Note: For these tests, use subsetted data from Hypocrisy simple effects test (previous code chunk).

```{r}
#Main effect 
#Never vs. rarely only
t.test(Honest_composite2 ~ proclamation, sometimes_exclude, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, sometimes_exclude, var.equal = TRUE))

#Never vs.sometimes  only
t.test(Honest_composite2 ~ proclamation, rarely_exclude, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, rarely_exclude, var.equal = TRUE))

#Rarely vs. sometimes  only
t.test(Honest_composite2 ~ proclamation, never_exclude, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, never_exclude, var.equal = TRUE))

#Proclamation within levels of behavior, subsetted data

#Selfish truth: sometimes vs. rarely 
t.test(Honest_composite2 ~ proclamation, never_truth, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, never_truth, var.equal = TRUE))

#Prosocial lie: sometimes vs. rarely 
t.test(Honest_composite2 ~ proclamation, never_lie, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, never_lie, var.equal = TRUE))

#Selfish truth: never vs. sometimes
t.test(Honest_composite2~ proclamation, rarely_truth, var.equal = TRUE)
t_apa(t.test(Honest_composite2~ proclamation, rarely_truth, var.equal = TRUE))

#Prosocial lie: never vs. sometimes
t.test(Honest_composite2 ~ proclamation, rarely_lie, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, rarely_lie, var.equal = TRUE))

#Selfish truth: never vs. rarely
t.test(Honest_composite2 ~ proclamation, sometimes_truth, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, sometimes_truth, var.equal = TRUE))

#Prosocial lie: never vs. rarely
t.test(Honest_composite2 ~ proclamation, sometimes_lie, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, sometimes_lie, var.equal = TRUE))

#Alternative ANOVA and tukey post-hoc tests
hon_model = aov_ez('ID', 'Honest_composite2', s2,
                    within = c (),
                    between = c ('proclamation', 'behavior'),
                    anova_table = list(es = 'pes'))
print(hon_model)
means <- emmeans(hon_model, ~ proclamation|behavior)
print(means)
post1 <- emmeans(hon_model, ~ proclamation|behavior)
pairs(post1)  
post2 <- emmeans(hon_model, ~ proclamation)
pairs(post2)  
```

#Behavior Model

"rv" is trust in the RELY-or-VERIFY game. 1 = RELY, 0 = VERIFY.

```{r}
#Reported Model
rv.glm <- glm(rv ~ sometimes + rarely + behavlie + 
                sometimes*behavlie + rarely*behavlie,
              data=s2, family = binomial(link = "logit"))
summary(rv.glm)

#Exploratory
rv.glm2 <- glm(rv ~ never + rarely + behavlie + 
                never*behavlie + rarely*behavlie,
              data=s2, family = binomial(link = "logit"))
summary(rv.glm2)


#Frequencies - proclamation
table(s2$proclamation, s2$rv) #1 = RELY, 0 = VERIFY

#never verify: 103/192, 54%
#rarely verify: 111/202, 55%
#sometimes  verify: 145 /204, 71%

#never rely: 89/192, 46%
#rarely rely: 91/202, 45%
#sometimes  rely: 59/204, 29%

#Frequencies proclamation and behavior by cell
table(s2$proclamation, s2$behavior, s2$rv)
table(s2$behavior, s2$rv) 


#Compare to equilibrium

#equilibrium 40% rely
#sometimes = 29% rely
prop.test(59, 204, p = .4, correct = FALSE)


```

#Attitudes Towards Honesty Measure

#Distribution of Responses

```{r}
table(s2$pref)
#94 "never" (5) / 598, 16%
#297 "rarely" (4) / 598, 50%
#195 "sometimes" (3) / 598, 33%
#10 "often" (2) -  1.7%
#2 "always" (1) - .3%

```


#Center honesty preferences for use in models

```{r}
s2 <- mutate(s2, pref.center = scale(s2$pref))

```

# SI Appendix 3 - Regressions

```{r}
#Preferences Regression - Hypocrisy
hypocrisy.lm <- lm(Hypocrisy_composite2 ~ sometimes + rarely + sometimes*pref.center + rarely*pref.center, data= s2)
summary(hypocrisy.lm)

#Look at mean hypocrisy ratings by proclamation and preferences 
tapply(s2$Hypocrisy_composite2, list(s2$proclamation, s2$pref), mean)
tapply(s2$Hypocrisy_composite2, list(s2$sometimes, s2$pref), mean)
tapply(s2$Hypocrisy_composite2, s2$sometimes, mean)
tapply(s2$Hypocrisy_composite2, s2$sometimes, sd)

#Preferences Regression - Morality
moral.lm <- lm(Moral_composite2 ~ sometimes + rarely + sometimes*pref.center + rarely*pref.center, data= s2)
summary(moral.lm)

#Look at mean morality ratings by proclamation and preferences 
tapply(s2$Moral_composite2, list(s2$proclamation, s2$pref), mean)
tapply(s2$Moral_composite2, list(s2$sometimes, s2$pref), mean)
tapply(s2$Moral_composite2, s2$proclamation, mean)
tapply(s2$Moral_composite2, s2$rarely, mean)
tapply(s2$Moral_composite2, s2$sometimes, mean)
tapply(s2$Moral_composite2, s2$sometimes,sd)

#Preferences Regression - Future Honesty
honest.lm <- lm(Honest_composite2 ~ sometimes + rarely + sometimes*pref.center + rarely*pref.center, data= s2)
summary(honest.lm)

#Look at mean future honesty ratings by proclamation and preferences 
tapply(s2$Honest_composite2, list(s2$proclamation, s2$pref), mean)
tapply(s2$Honest_composite2, list(s2$sometimes, s2$pref), mean)
tapply(s2$Honest_composite2, s2$proclamation, mean)
tapply(s2$Honest_composite2, s2$pref, mean)
tapply(s2$Honest_composite2, s2$rarely, mean)
tapply(s2$Honest_composite2, s2$sometimes, mean)
tapply(s2$Honest_composite2, s2$sometimes, sd)

#Logistic Regression (trust) with own attitudes towards honesty
rv3.glm <- glm(rv ~ sometimes*pref.center,
              data=s2, family = binomial(link = "logit"))
summary(rv3.glm)

#Frequencies
table(s2$rv, s2$pref, s2$sometimes)
table(s2$rv, s2$pref)
#note that separate tables 0 = never/rarely , 1 = sometimes; within tables, 0 = verify, 1 = rely
#total per cell
table(s2$pref)

#Percentages RELY on never/rarely
#always 0/2, 0%
#often, 3/10 30%
#sometimes, 45/195 23%
#rarely, 99/297 33%
#never, 33/94

#Percentages RELY on sometimes
#always 0/2, 0%
#often, 1/10 10%
#sometimes, 28/195 14%
#rarely, 26/297 9%
#never, 4/94 4%

```

# Attitudes as a Covariate - exploration

```{r}
#Preferences Covariate - Hypocrisy
hypocrisy_pref.center.afex <-aov_car(Hypocrisy_composite2 ~ proclamation*behavior + pref.center + Error(ID), data= s2, factorize = FALSE, anova_table = list(es = "pes"))
summary(hypocrisy_pref.center.afex)

#Preferences Covariate - Moral
moral_pref2.afex <- aov_car(Moral_composite2 ~ proclamation*behavior + pref.center + Error(ID), data= s2, factorize = FALSE, anova_table = list(es = "pes"))
summary(moral_pref2.afex)

#Preferences Covariate - Future honesty
honest.pref.center.afex <-aov_car(Honest_composite2 ~ proclamation*behavior + pref.center + Error(ID), data= s2, factorize = FALSE, anova_table = list(es = "pes"))
summary(honest.pref.center.afex)

```

#Notes

The moderated mediation models on moral character and trust behavior were conducted in SPSS. The syntax is copied below for use within SPSS.

# Syntax

Study 2 Trust: First, Open "HypocrisyStudy2_cleaned.xlsx" within SPSS. This excel file is available in this R project and on the OSF page for this project. Then run the code below.

*1. Recreate composite variables*
COMPUTE Hypocrisy_C=MEAN(Hypocrisy_1,Hypocrisy_2,Hypocrisy_3,Hypocrisy_4,Hypocrisy_5).
EXECUTE.

COMPUTE Honesty_C=MEAN(Honest_frequency,Honest_likely,Honest_extreme,Honest_committment).
EXECUTE.

*2. Run mediation analysis to get indirect effects. - use point and click within Process Macro*

*Run Hayes’ (2018) PROCESS Macro for SPSS, Model 7, 10,000 bootstraps*
IV = sometimes
M1 = Honesty_C
M2 = Hypocrisy_C
Y = rv
W = behavlie

*3. Run regressions to get X-->M and M-->Y pathways for each level of moderator.*

SORT CASES  BY behavlie.
SPLIT FILE LAYERED BY behavlie.

*Test M-->Y pathways*

LOGISTIC REGRESSION VARIABLES rv
  /METHOD=ENTER Hypocrisy_C Honesty_C sometimes 
  /CRITERIA=PIN(.05) POUT(.10) ITERATE(20) CUT(.5).


*Test X-->M1 pathway*

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS R ANOVA
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT Honesty_C
  /METHOD=ENTER sometimes.
  
  *Test X-->M2 pathway*

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS R ANOVA
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT Hypocrisy_C
  /METHOD=ENTER sometimes.


Study 2 Morality: Use the same data file in SPSS.

*1. Recreate composite variables*

COMPUTE Hypocrisy_C=MEAN(Hypocrisy_1,Hypocrisy_2,Hypocrisy_3,Hypocrisy_4,Hypocrisy_5).
EXECUTE.

COMPUTE Honesty_C=MEAN(Honest_frequency,Honest_likely,Honest_extreme,Honest_committment).
EXECUTE.

COMPUTE Moral_C=MEAN(Moral_1, Moral_2, Moral_3).
EXECUTE.

*2. Run mediation analysis to get indirect effects. - use point and click within Process Macro*

*Run Hayes’ (2016) PROCESS Macro for SPSS, Model 7, 10,000 bootstraps*
IV = sometimes
M1 = Hypocrisy_C
M2 = Honesty_C
Y = Moral_C
W = behavlie

*3. Run regressions to get X-->M and M-->Y pathways for each level of moderator.*

SORT CASES  BY behavlie.
SPLIT FILE LAYERED BY behavlie.

*Test M-->Y pathways*

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS R ANOVA
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT Moral_C
  /METHOD=ENTER sometimes Hypocrisy_C, Honesty_C.
  
  *Test X-->M1 pathway*

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS R ANOVA
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT Honesty_C
  /METHOD=ENTER sometimes.

*Test X-->M2 pathway*

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS R ANOVA
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT Hypocrisy_C
  /METHOD=ENTER sometimes.

