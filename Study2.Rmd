---
title: "NEW_study2"
author: "Elizabeth Huppert"
date: "1/6/2021"
output: pdf_document
---

#Set-up and Read in Data

You need to install the following packages to run this code:

-here
-tidyverse
-afex
-apa
-psych
-dplyr


```{r setup, include=FALSE}
library(here)
library(tidyverse)
library(afex)
library(apa)
library(psych)
library(dplyr)
library(lavaan)

#read in data

s2 <- read.csv(here("HypocrisyStudy2_cleaned.csv")) #271


```

Note: The current csv file imported for this analysis reflects cleaned data. 
The raw data and more information about the cleaning/coding of variables that went into making the current clean csv file is available in the Excel codebook. Additionally, more information is available upon request.


Key variable names (also see codebook for more information):

1. Proclamation:
Assignment to absolute honesty stance vs. flexible honesty stance vs. control

2. Voting:
Likelihood of voting for Matthew Johnson (1 -7)

3. Discount:
Extent to which participants actually think Matthew Johnson lies (1-7)

4. Goals
Extent to which participants actually think Matthew Johnsons thinks its okay to lie (1-7)

# Composite Evaluation Variables 

Items with high agreement were combined as per our pre-registration.

```{r}
#Hypocrisy
s2_NEW.test.df <- data.frame(s2_NEW$h1, s2_NEW$h2, s2_NEW$h3, s2_NEW$h4, s2_NEW$h5)
summary(s2_NEW.test.df)
describe(s2_NEW.test.df)
psych::alpha(s2_NEW.test.df) #alpha = 0.89 so combine
s2_NEW <- mutate(s2_NEW, h_composite2= ((s2_NEW$h1+s2_NEW$h2+s2_NEW$h3+s2_NEW$h4+s2_NEW$h5)/5))

#Morality
moral.test.df <- data.frame(s2_NEW$m1, s2_NEW$m2, s2_NEW$m3)
summary(moral.test.df)
describe(moral.test.df)
psych::alpha(moral.test.df) #alpha = 0.94 so combine

s2_NEW <- mutate(s2_NEW, m_composite2 = ((s2_NEW$m1+s2_NEW$m2+s2_NEW$m3)/3))

#Future Honesty
honest.test.df <- data.frame(s2_NEW$hf, s2_NEW$hl, s2_NEW$he, s2_NEW$ch)
summary(honest.test.df)
describe(honest.test.df)
psych::alpha(honest.test.df) #alpha = 0.74
s2_NEW <- mutate(s2_NEW, Honest_composite2 = ((s2_NEW$hl+s2_NEW$hf+s2_NEW$he+s2_NEW$ch)/4))

#Social benefit of the proclamation
cor.test(s2_NEW$s1, s2_NEW$s2) #r = 0.87
s2_NEW <- mutate(s2_NEW, SI_composite2 = ((s2_NEW$s1+s2_NEW$s2)/2))
```

Evaluation variables:

Hypocrisy_composite2 = hypocrisy composite of 5 items (Ratings: 1-7)
Moral_composite2 = morality composite of 3 items (Ratings: 1-7)
Honest_composite2 = honesty thresholds composite of 4 items (Ratings: 1-7)
SI_composite2 = perceived social benefit of the proclamation composite of 2 items (Ratings: 1-7)


# Voting Intentions Model

```{r}
vote_2new.afex <-aov_car(v1 ~ proclamation + Error(ID), data= s2_NEW)
summary(vote_2new.afex) 
anova_apa(vote_2new.afex)  #main effect of proc

```

# Voting Descriptives

```{r}

#Across Proclamations
tapply(s2_NEW$v1, s2_NEW$proclamation, mean)
tapply(s2_NEW$v1, s2_NEW$proclamation, sd)
tapply(s2_NEW$v1, s2_NEW$proclamation, length)

```

# Voting Simple Effects - Subsetting Data

```{r}
#Subset for main effects tests

abs_exclude <- s2_NEW %>%
  filter(proclamation != "absolute") #182

flex_exclude  <- s2_NEW %>%
  filter(proclamation != "flexible") #186 - rarely

control_exclude <- s2_NEW %>%
  filter(proclamation != "control") #162


# Main effect: abs vs. flex vs. control
#Abs vs. Flex 
t.test(v1 ~ proclamation, control_exclude, var.equal = TRUE)
t_apa(t.test(v1 ~ proclamation, control_exclude, var.equal = TRUE))

#Abs vs. control
t.test(v1 ~ proclamation, flex_exclude, var.equal = TRUE)
t_apa(t.test(v1 ~ proclamation, flex_exclude, var.equal = TRUE))

#Flex vs. control
t.test(v1 ~ proclamation, abs_exclude, var.equal = TRUE)
t_apa(t.test(v1 ~ proclamation, abs_exclude, var.equal = TRUE))

```


# Hypocrisy Model

```{r}
hypocrisy_2new.afex <-aov_car(h_composite2 ~ proclamation + Error(ID), data= s2_NEW)
summary(hypocrisy_2new.afex) 
anova_apa(hypocrisy_2new.afex)  #main effect of proc
```

# Hypocrisy Descriptives

```{r}
#Across Proclamations
tapply(s2_NEW$h_composite2, s2_NEW$proclamation, mean)
tapply(s2_NEW$h_composite2, s2_NEW$proclamation, sd)
tapply(s2_NEW$h_composite2, s2_NEW$proclamation, length)

```

# Hypocrisy Simple Effects - Use Subsetted Data from Voting Intentions Model

```{r}
# Main effect: abs vs. flex vs. control
#Abs vs. Flex 
t.test(h_composite2 ~ proclamation, control_exclude, var.equal = TRUE)
t_apa(t.test(h_composite2 ~ proclamation, control_exclude, var.equal = TRUE))

#Abs vs. control
t.test(h_composite2 ~ proclamation, flex_exclude, var.equal = TRUE)
t_apa(t.test(h_composite2 ~ proclamation, flex_exclude, var.equal = TRUE))

#Flex vs. control
t.test(h_composite2 ~ proclamation, abs_exclude, var.equal = TRUE)
t_apa(t.test(h_composite2 ~ proclamation, abs_exclude, var.equal = TRUE))

```

# Morality Model

```{r}
morality_2new.afex <-aov_car(m_composite2 ~ proclamation + Error(ID), data= s2_NEW)
summary(morality_2new.afex) 
anova_apa(morality_2new.afex)  #main effect of proc
```

# Morality Descriptives

```{r}
#Across Proclamations
tapply(s2_NEW$m_composite2, s2_NEW$proclamation, mean)
tapply(s2_NEW$m_composite2, s2_NEW$proclamation, sd)
tapply(s2_NEW$m_composite2, s2_NEW$proclamation, length)

```

# Morality Simple Effects - Use Subsetted Data from Voting Intentions Model

```{r}
# Main effect: abs vs. flex vs. control
#Abs vs. Flex 
t.test(m_composite2 ~ proclamation, control_exclude, var.equal = TRUE)
t_apa(t.test(m_composite2 ~ proclamation, control_exclude, var.equal = TRUE))

#Abs vs. control
t.test(m_composite2 ~ proclamation, flex_exclude, var.equal = TRUE)
t_apa(t.test(m_composite2 ~ proclamation, flex_exclude, var.equal = TRUE))

#Flex vs. control
t.test(m_composite2 ~ proclamation, abs_exclude, var.equal = TRUE)
t_apa(t.test(m_composite2 ~ proclamation, abs_exclude, var.equal = TRUE))
```

# Future Honesty Model

```{r}
honesty_2new.afex <-aov_car(Honest_composite2 ~ proclamation + Error(ID), data= s2_NEW)
summary(honesty_2new.afex) 
anova_apa(honesty_2new.afex)  #main effect of proc
```

# Future Honesty Descriptives

```{r}
#Across Proclamations
tapply(s2_NEW$Honest_composite2, s2_NEW$proclamation, mean)
tapply(s2_NEW$Honest_composite2, s2_NEW$proclamation, sd)
tapply(s2_NEW$Honest_composite2, s2_NEW$proclamation, length)

```

# Future Honesty Simple Effects - Use Subsetted Data from Voting Intentions Model

```{r}
# Main effect: abs vs. flex vs. control
#Abs vs. Flex 
t.test(Honest_composite2 ~ proclamation, control_exclude, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, control_exclude, var.equal = TRUE))

#Abs vs. control
t.test(Honest_composite2 ~ proclamation, flex_exclude, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, flex_exclude, var.equal = TRUE))

#Flex vs. control
t.test(Honest_composite2 ~ proclamation, abs_exclude, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ proclamation, abs_exclude, var.equal = TRUE))
```

# Social Benefit of the Proclamation Model - New Subsetted Data


# Subset Data

```{r}
#get rid of control since no social benefit here
absflex_only <- s2_NEW %>%
  filter (proclamation != "control")

```


# Social Benefit of the Proclamation Model

```{r}
SI_2new.afex <-aov_car(SI_composite2 ~ proclamation + Error(ID), data= absflex_only)
summary(SI_2new.afex) 
anova_apa(SI_2new.afex)  #main effect of proc
```

# Social Benefit of the Proclamation Descriptives

```{r}
#Across Proclamations
tapply(s2_NEW$SI_composite2, s2_NEW$proclamation, mean)
tapply(s2_NEW$SI_composite2, s2_NEW$proclamation, sd)
tapply(s2_NEW$SI_composite2, s2_NEW$proclamation, length)

```

# Discounting Model

```{r}
#Discounting
discounting2.afex <-aov_car(d1~ proclamation + Error(ID), data= s2_NEW)
summary(discounting2.afex) 
anova_apa(discounting2.afex)  #main effect of proc
```

# Discounting Descriptives

```{r}
#Across Proclamations
tapply(s2_NEW$d1, s2_NEW$proclamation, mean)
tapply(s2_NEW$d1, s2_NEW$proclamation, sd)
tapply(s2_NEW$d1, s2_NEW$proclamation, length)
```

# Goals  Model

```{r}
goals2.afex <-aov_car(g1 ~ proclamation + Error(ID), data= s2_NEW)
summary(goals2.afex) 
anova_apa(goals2.afex)  #main effect of proc
```

# Goals Descriptives

```{r}
#Across Proclamations
tapply(s2_NEW$g1, s2_NEW$proclamation, mean)
tapply(s2_NEW$g1, s2_NEW$proclamation, sd)
tapply(s2_NEW$g1, s2_NEW$proclamation, length)
```

# Exploratory Continued

See the attached R script "Study2_mediation.R" for the multiple mediation analysis. As mentioned, further analysis notes available upon request. Make sure to run this Rmarkdown file code before running the mediation to get composite variables.