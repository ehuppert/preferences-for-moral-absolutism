---
title: "Study 2"
author: "Elizabeth Huppert"
date: "11/7/2022"
output: pdf_document
---

#Set-up and Read in Data

You need to install the following packages to run this code:

-here
-tidyverse
-afex
-apa
-psych
-dplyr


```{r setup, include=FALSE}
library(here)
library(tidyverse)
library(afex)
library(apa)
library(psych)
library(dplyr)
library(lavaan)

#read in data

s2 <- read.csv(here("HypocrisyStudy2_cleaned.csv")) #564
```

Note: The current csv file imported for this analysis reflects cleaned data. 
The raw data and more information about the cleaning/coding of variables that went into making the current clean csv file is available in the Excel codebook. Additionally, more information is available upon request.


Key variable names (also see codebook for more information):

1. Proclamation:
Assignment to absolute honesty stance vs. flexible honesty stance vs. control

2. Voting:
Likelihood of voting for Matthew Johnson (1 -7)


# Factorize Subject (id)

```{r}
s2$ID <- as.factor(s2$ID)
```

# Composite Evaluation Variables 

Items with high agreement were combined as per our pre-registration.

# Time One Variables

```{r}
#Moral
moral2_t1_check <- data.frame(s2$Moral1_T1, s2$Moral2_T1, s2$Moral3_T1)
summary(moral2_t1_check)
describe(moral2_t1_check)
psych::alpha(moral2_t1_check) #alpha = 0.98

s2 <- mutate(s2, 
             Moral_composite2_t1 = 
               ((s2$Moral1_T1 + s2$Moral2_T1 + s2$Moral3_T1)/3))

#Future Honesty
honesty2_t1_check  <- data.frame(s2$Honest_frequencyT1, s2$Honest_likelihoodT1,
                                 s2$Honest_extremeT1, s2$Honest_committmentT1)
summary(honesty2_t1_check)
describe(honesty2_t1_check)
psych::alpha(honesty2_t1_check) #alpha = 0.89
s2 <- mutate(s2, Honest_composite2_t1 = 
               ((s2$Honest_frequencyT1+ s2$Honest_likelihoodT1+
                   s2$Honest_extremeT1 + s2$Honest_committmentT1)/4))

```

Evaluation variables:

Moral_composite2_t1 = morality composite of 3 items (Ratings: 1-7)
Honest_composite2_t1 = honesty thresholds composite of 4 items (Ratings: 1-7)

# Time Two Variables

```{r}
#Hypocrisy
hypocrisy2_check <- data.frame(s2$Hypocrisy_1, s2$Hypocrisy_2, s2$Hypocrisy_3, s2$Hypocrisy_4, s2$Hypocrisy_5)
summary(hypocrisy2_check)
describe(hypocrisy2_check)
psych::alpha(hypocrisy2_check) #alpha = 0.88
s2 <- mutate(s2, Hypocrisy_composite2= 
               ((s2$Hypocrisy_1 + s2$Hypocrisy_2 + s2$Hypocrisy_3 +
                   s2$Hypocrisy_4 + s2$Hypocrisy_5)/5))

#Morality
moral2_t2_check <- data.frame(s2$Moral1_T2, s2$Moral2_T2, s2$Moral3_T2)
summary(moral2_t2_check)
describe(moral2_t2_check)
psych::alpha(moral2_t2_check) #alpha = 0.97

s2 <- mutate(s2, 
             Moral_composite2_t2 = 
               ((s2$Moral1_T2 + s2$Moral2_T2+s2$Moral3_T2)/3))

#Future Honesty
honesty2_t2_check  <- data.frame(s2$Honest_frequencyT2, s2$Honest_likelihoodT2, s2$Honest_extremeT2, s2$Honest_committmentT2)
summary(honesty2_t2_check)
describe(honesty2_t2_check)
psych::alpha(honesty2_t2_check) #alpha = 0.81
s2 <- mutate(s2, 
             Honest_composite2_t2 = 
               ((s2$Honest_frequencyT2 + s2$Honest_likelihoodT2 +
                   s2$Honest_extremeT2 + s2$Honest_committmentT2)/4))

```

Evaluation variables:

Hypocrisy_composite2 = hypocrisy composite of 5 items (Ratings: 1-7)
Moral_composite2_t2 = morality composite of 3 items (Ratings: 1-7)
Honest_composite2_t2 = honesty thresholds composite of 4 items (Ratings: 1-7)


# Voting Intentions Model

```{r}
Voting_2.afex <-aov_car(Voting ~ Proclamation + Error(ID), data= ss2)
summary(Voting_2.afex) 
anova_apa(Voting_2.afex)  
```

# Voting Descriptives

```{r}
#Across Proclamations
tapply(ss2$Voting, s13$Proclamation, mean)
tapply(ss2$Voting, s13$Proclamation, sd)
tapply(ss2$Voting, s13$Proclamation, length)
```

# Voting Simple Effects - Subsetting Data

```{r}
#Subset for main effects tests
abs_exclude <- ss2 %>%
  filter(Proclamation != "absolute") #182

flex_exclude  <- ss2 %>%
  filter(Proclamation != "flexible") #186 - rarely

control_exclude <- ss2 %>%
  filter(Proclamation != "control") #162


# Main effect: abs vs. flex vs. control
#Abs vs. Flex 
t.test(Voting ~ Proclamation, control_exclude, var.equal = TRUE)
t_apa(t.test(Voting ~ Proclamation, control_exclude, var.equal = TRUE))

#Abs vs. control
t.test(Voting ~ Proclamation, flex_exclude, var.equal = TRUE)
t_apa(t.test(Voting ~ Proclamation, flex_exclude, var.equal = TRUE))

#Flex vs. control
t.test(Voting ~ Proclamation, abs_exclude, var.equal = TRUE)
t_apa(t.test(Voting ~ Proclamation, abs_exclude, var.equal = TRUE))

```
# Hypocrisy Model

```{r}
hypocrisy_2.afex <-aov_car(Hypocrisy_composite2 ~ Proclamation + Error(ID), data= ss2)
summary(hypocrisy_2.afex) 
anova_apa(hypocrisy_2.afex) 
```

# Hypocrisy Descriptives

```{r}
#Across Proclamations
tapply(s13$Hypocrisy_composite2, s13$Proclamation, mean)
tapply(s13$Hypocrisy_composite2, s13$Proclamation, sd)
tapply(s13$Hypocrisy_composite2, s13$Proclamation, length)

```

# Hypocrisy Simple Effects - Use Subsetted Data from Voting Intentions Model

```{r}
# Main effect: abs vs. flex vs. control
#Abs vs. Flex 
t.test(Hypocrisy_composite2 ~ Proclamation, control_exclude, var.equal = TRUE)
t_apa(t.test(Hypocrisy_composite2 ~ Proclamation, control_exclude, var.equal = TRUE))

#Abs vs. control
t.test(Hypocrisy_composite2 ~ Proclamation, flex_exclude, var.equal = TRUE)
t_apa(t.test(Hypocrisy_composite2 ~ Proclamation, flex_exclude, var.equal = TRUE))

#Flex vs. control
t.test(Hypocrisy_composite2 ~ Proclamation, abs_exclude, var.equal = TRUE)
t_apa(t.test(Hypocrisy_composite2 ~ Proclamation, abs_exclude, var.equal = TRUE))

```

# Morality Model

```{r}
```{r}
morality_2.afex <-aov_car(Moral_composite2 ~ Proclamation + Error(ID), data= ss2)
summary(morality_2.afex) 
anova_apa(morality_2.afex)

```

# Morality Descriptives

```{r}
#Across Proclamations
tapply(s13$Moral_composite2, s13$Proclamation, mean)
tapply(s13$Moral_composite2, s13$Proclamation, sd)
tapply(s13$Moral_composite2, s13$Proclamation, length)

```

# Morality Simple Effects - Use Subsetted Data from Voting Intentions Model

```{r}
# Main effect: abs vs. flex vs. control
#Abs vs. Flex 
t.test(Moral_composite2 ~ Proclamation, control_exclude, var.equal = TRUE)
t_apa(t.test(Moral_composite2 ~ Proclamation, control_exclude, var.equal = TRUE))

#Abs vs. control
t.test(Moral_composite2 ~ Proclamation, flex_exclude, var.equal = TRUE)
t_apa(t.test(Moral_composite2 ~ Proclamation, flex_exclude, var.equal = TRUE))

#Flex vs. control
t.test(Moral_composite2 ~ Proclamation, abs_exclude, var.equal = TRUE)
t_apa(t.test(Moral_composite2 ~ Proclamation, abs_exclude, var.equal = TRUE))
```

# Future Honesty Model

```{r}
honesty_2.afex <-aov_car(Honest_composite2 ~ Proclamation + Error(ID), data= ss2)
summary(honesty_2.afex) 
anova_apa(honesty_2.afex)  
```

# Future Honesty Descriptives

```{r}
#Across Proclamations
tapply(s13$Honest_composite2, s13$Proclamation, mean)
tapply(s13$Honest_composite2, s13$Proclamation, sd)
tapply(s13$Honest_composite2, s13$Proclamation, length)

```

# Future Honesty Simple Effects - Use Subsetted Data from Voting Intentions Model

```{r}
# Main effect: abs vs. flex vs. control
#Abs vs. Flex 
t.test(Honest_composite2 ~ Proclamation, control_exclude, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ Proclamation, control_exclude, var.equal = TRUE))

#Abs vs. control
t.test(Honest_composite2 ~ Proclamation, flex_exclude, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ Proclamation, flex_exclude, var.equal = TRUE))

#Flex vs. control
t.test(Honest_composite2 ~ Proclamation, abs_exclude, var.equal = TRUE)
t_apa(t.test(Honest_composite2 ~ Proclamation, abs_exclude, var.equal = TRUE))
```



