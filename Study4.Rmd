---
title: "Study 4"
author: "Elizabeth Huppert"
date: "5/42020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Set-up

You need to install the following packages to run this code:

-here
-tidyverse
-afex
-psych
-reshape2
-apa
-dplyr
-emmeans

#Load Packages and Data

```{r, include = FALSE}

library(here)
library(tidyverse)
library(psych)
library(reshape2)
library(afex)
library(apa)
library(dplyr)
library(emmeans)

#read in data

s4 <- read.csv(here("HypocrisyStudy4_cleaned.csv"))

```

Note: The current csv file imported for this analysis reflects cleaned data. 
The raw data and more information about the cleaning/coding of variables that went into making the current clean csv file is available in the Excel codebook. Additionally, more information is available upon request.


#Models

Key Variable Names (also see codebook for more information):

1. Proclamation:
Assignment to absolute vs. flexible honesty stance

2. Order:
Survey1 vs. game1 refers to order in which target information is presented

-survey1 (evaluations at timepoint 1 after just survey information, evaluations at timepoint 2 after the proscoial lie behavior)
-game1 (evaluations at timepoint 1 after just prosocial lie behavior, timepoint 2 is the survey information)

3. Time:
Within subject factor, evaluations are reported at two points in time

For supplement (The Choice Game):
Trustbeh = KEEP or PASS in The Coin Flip Game 
(0 = KEEP, 1 = PASS)

#Recode proclamation for ease of interpretation

```{r}
s4$proclamation <- factor(s4$proclamation, levels = c("ambiguous", "absolute"))
```

#Composite evaluation variables

Items with high agreement were combined as per our pre-registration.

```{r}
#Time one 
#Hypocrisy
hypocrisy_4_check <- data.frame(s4$hypocrisy_1, s4$hypocrisy_2, s4$hypocrisy_4, s4$hypocrisy_5)
summary(hypocrisy_4_check)
describe(hypocrisy_4_check)
psych::alpha(hypocrisy_4_check) #alpha = 0.89 
s4 <- mutate(s4, Hypocrisy1_composite4 = ((s4$hypocrisy_1 + s4$hypocrisy_2 + s4$hypocrisy_4 + s4$hypocrisy_5)/4))

#Morality
morality4_check <- data.frame(s4$moral_1, s4$moral_2, s4$moral_3)
summary(morality4_check )
describe(morality4_check )
psych::alpha(morality4_check ) #alpha = 0.97
s4 <- mutate(s4, Moral.1_composite4 = ((s4$moral_1 +s4$moral_2 + s4$moral_3)/3))

#Future Honesty
Honest4_df <- data.frame(s4$honest_freq_1, s4$honest_likely_1, s4$honest_extreme_1, s4$committment_honesty_1)
summary(Honest4_df)
describe(Honest4_df)
psych::alpha(Honest4_df) #alpha = 0.85
s4 <- mutate(s4, Honest_composite4= ((s4$honest_freq_1 + s4$honest_likely_1 + s4$honest_extreme_1 + s4$committment_honesty_1)/4))


#Time two  
#Hypocrisy
hypocrisy_4_check.2 <- data.frame(s4$hypocrisy_1.2, s4$hypocrisy_2.2, s4$hypocrisy_4.2, s4$hypocrisy_5.2)
summary(hypocrisy_4_check.2)
describe(hypocrisy_4_check.2)
psych::alpha(hypocrisy_4_check.2) #alpha = 0.91
s4 <- mutate(s4, 
             Hypocrisy2_composite4 = (s4$hypocrisy_1.2 + s4$hypocrisy_2.2 + s4$hypocrisy_4.2 + s4$hypocrisy_5.2)/4)

#Morality
morality4_check.2 <- data.frame(s4$moral_1.2, s4$moral_2.2, s4$moral_3.2)
summary(morality4_check.2)
describe(morality4_check.2)
psych::alpha(morality4_check.2) #alpha = 0.97
s4 <- mutate(s4, Moral.2_composite4  = ((s4$moral_1.2+s4$moral_2.2+s4$moral_3.2)/3))

#Future Honesty
Honest4_df.2  <- data.frame(s4$honest_freq_2, s4$honest_likely_2, s4$honest_extreme_2, s4$committment_honesty_2)
summary(Honest4_df.2)
describe(Honest4_df.2)
psych::alpha(Honest4_df.2) #alpha = 0.82
s4 <- mutate(s4, Honest_composite4.2 = ((s4$honest_freq_2 + s4$honest_likely_2 + s4$honest_extreme_2 + s4$committment_honesty_2)/4))

#Supplemental (guilt and moral standards) 
#Guilt time 1
cor.test(s4$guilt_1, s4$guilt_2) #r = 0.93
s4 <- mutate(s4, Guilt_composite = ((s4$guilt_1+s4$guilt_2)/2))

#Moral Standards time 1
cor(s4$moral_standards1, s4$moral_standards1.2)
cor.test(s4$moral_standards1, s4$moral_standards2) #r = 0.37; not combined

#Guilt time 2
cor.test(s4$guilt_1.2, s4$guilt_2.2) #r = 0.91
s4 <- mutate(s4, Guilt.2_composite = ((s4$guilt_1.2 + s4$guilt_2.2)/2))

#Moral Standards time 2
cor.test(s4$moral_standards1.2, s4$moral_standards2.2) # .48; not combined

```

Evaluation variables:

Timepoint 1:

Hypocrisy1_composite4 = hypocrisy composite of 4 items at timepoint 1 
Guilt_composite = guilt composite of 2 items at timepoint 1
Moral.1_composite4 = morality composite of 3 items at timepoint 1
Honest_composite4 = committment to honesty composite of 4 items at timepoint 1

Timepoint 2 (same 1-7 Likert-type scales):

Hypocrisy2_composite4  = hypocrisy composite of 4 items at timepoint 2
Guilt_composite = guilt composite of 2 items at timepoint 2
Moral.2_composite4 = morality composite of 3 items at timepoint 2
Honest_composite4.2 = committment to honesty composite of 4 items at timepoint 2

#Hypocrisy Model

```{r}
#Dataframe for Hypocrisy
hypocrisy_df <-melt(s4, 
                id.vars=c("condition", "ID", "proclamation", "order"),
                #measure command is for the DV
                measure.vars=c("Hypocrisy1_composite4","Hypocrisy2_composite4"),
                variable.name="hypocrisy.time",
                value.name="hypocrisy.value"
)

#ANOVA
hypocrisy4.afex <- aov_car(
  hypocrisy.value ~ proclamation*order*hypocrisy.time + Error(ID/hypocrisy.time),
  data = hypocrisy_df)
summary(hypocrisy4.afex)
anova_apa(hypocrisy4.afex)

```

#Descriptives Hypocrisy

```{r}
#Cells
tapply(hypocrisy_df$hypocrisy.value, 
       list(hypocrisy_df$proclamation, hypocrisy_df$order, hypocrisy_df$hypocrisy.time), 
       FUN = mean)

tapply(hypocrisy_df$hypocrisy.value, 
       list(hypocrisy_df$proclamation, hypocrisy_df$order, hypocrisy_df$hypocrisy.time), 
       FUN = sd)

tapply(hypocrisy_df$hypocrisy.value, 
       list(hypocrisy_df$proclamation, hypocrisy_df$order, hypocrisy_df$hypocrisy.time), 
       FUN = length)

#Across Proclamation and Time
tapply(hypocrisy_df$hypocrisy.value, list(hypocrisy_df$proclamation, hypocrisy_df$hypocrisy.time),
       FUN = length)

tapply(hypocrisy_df$hypocrisy.value, list(hypocrisy_df$proclamation, hypocrisy_df$hypocrisy.time),
       FUN = mean)

tapply(hypocrisy_df$hypocrisy.value, list(hypocrisy_df$proclamation, hypocrisy_df$hypocrisy.time),
       FUN = sd)

#Across Order and Time
tapply(hypocrisy_df$hypocrisy.value, list(hypocrisy_df$order, 
                                                hypocrisy_df$hypocrisy.time),FUN = length)
tapply(hypocrisy_df$hypocrisy.value, list(hypocrisy_df$order, 
                                                hypocrisy_df$hypocrisy.time),FUN = mean)
tapply(hypocrisy_df$hypocrisy.value, list(hypocrisy_df$order, 
                                                hypocrisy_df$hypocrisy.time),FUN = sd)

#Across Proclamation and Order
tapply(hypocrisy_df$hypocrisy.value, list(hypocrisy_df$proclamation, 
                                                hypocrisy_df$order),FUN = length)
tapply(hypocrisy_df$hypocrisy.value, list(hypocrisy_df$proclamation, 
                                                hypocrisy_df$order),FUN = mean)
tapply(hypocrisy_df$hypocrisy.value, list(hypocrisy_df$proclamation, 
                                                hypocrisy_df$order),FUN = sd)

#Across Proclamation
tapply(hypocrisy_df$hypocrisy.value, hypocrisy_df$proclamation,FUN = mean)
tapply(hypocrisy_df$hypocrisy.value, hypocrisy_df$proclamation,FUN = sd)
tapply(hypocrisy_df$hypocrisy.value, hypocrisy_df$proclamation,FUN = length)

#Across Time
tapply(hypocrisy_df$hypocrisy.value, hypocrisy_df$hypocrisy.time,FUN = mean)
tapply(hypocrisy_df$hypocrisy.value, hypocrisy_df$hypocrisy.time,FUN = sd)
tapply(hypocrisy_df$hypocrisy.value, hypocrisy_df$hypocrisy.time,FUN = length)

#AcrossOrder
tapply(hypocrisy_df$hypocrisy.value, hypocrisy_df$order,FUN = mean)
tapply(hypocrisy_df$hypocrisy.value, hypocrisy_df$order,FUN = sd)
tapply(hypocrisy_df$hypocrisy.value, hypocrisy_df$order,FUN = length)

#Overall
mean(hypocrisy_df$hypocrisy.value)
sd(hypocrisy_df$hypocrisy.value)
length(hypocrisy_df$hypocrisy.value)

```

#Follow-up tests for two*way interactions: Hypocrisy

```{r}
#Proclamation*Time - paired t-tests

#Time 1 vs. 2 on absolute only
#Paired t-test
absolute_s4 <- s4 %>%
  filter(proclamation == "absolute")

t.test(absolute_s4$Hypocrisy1_composite4, absolute_s4$Hypocrisy2_composite4, paired = TRUE)
t_apa(t.test(absolute_s4$Hypocrisy1_composite4, absolute_s4$Hypocrisy2_composite4, paired = TRUE))

#Time 1 vs. 2 on flexible only
#Paired t-test
flexible_s4 <- s4 %>%
  filter(proclamation == "ambiguous")

t.test(flexible_s4$Hypocrisy1_composite4, flexible_s4$Hypocrisy2_composite4, paired = TRUE)
t_apa(t.test(flexible_s4$Hypocrisy1_composite4, flexible_s4$Hypocrisy2_composite4, paired = TRUE))

#Proclamation*Order - simple linear regressions

#Effect of order in just absolute
absolute_hypo <- hypocrisy_df %>%
  filter(proclamation ==  "absolute")
lm_order.hypo <- lm(hypocrisy.value ~ order, data = absolute_hypo)
summary(lm_order.hypo)

#Effect of order in just flexible
flexible_hypo <- hypocrisy_df %>%
  filter(proclamation ==  "ambiguous")
lm_order2.hypo <- lm(hypocrisy.value ~ order, data = flexible_hypo)
summary(lm_order2.hypo)

#Effect of proc in just survey1
survey1_hypo <- hypocrisy_df %>%
  filter(order==  "survey1")
lm_order3.hypo <- lm(hypocrisy.value ~ proclamation, data = survey1_hypo)
summary(lm_order3.hypo )

#Effect of proc in just game1
game1_hypo <- hypocrisy_df %>%
  filter(order==  "game1")
lm_order4.hypo <- lm(hypocrisy.value ~ proclamation, data = game1_hypo)
summary(lm_order4.hypo)

#Alternative ANOVA and tukey post-hoc tests
hyp_model = aov_ez('ID', 'hypocrisy.value', hypocrisy_df,
                    within = c ('hypocrisy.time'),
                    between = c ('proclamation', 'order'),
                    anova_table = list(es = 'pes'))
print(hyp_model)
ptmeans <- emmeans(hyp_model, ~ hypocrisy.time|proclamation)
print(ptmeans)
pomeans <- emmeans(hyp_model, ~ order|proclamation)
print(pomeans)
post1 <- emmeans(hyp_model, ~ hypocrisy.time|proclamation)
pairs(post1)
post2 <- emmeans(hyp_model, ~ order|proclamation)
pairs(post2) 
post3 <- emmeans(hyp_model, ~ proclamation|order)
pairs(post3) 

```

#Morality 

```{r}
#Dataframe for Morality
hypo_moral4 <-melt(s4, 
                       id.vars=c("condition", "ID","proclamation", "order"),
                       #measure command is for the DV
                       measure.vars=c("Moral.1_composite4","Moral.2_composite4"),
                       variable.name="moral.time",
                       value.name="moral.value"
)

#ANOVA
moral.afex <- aov_car(moral.value ~ proclamation*order*moral.time + Error(ID/moral.time), data=hypo_moral4)
summary(moral.afex)
anova_apa(moral.afex)

```

# Morality Descriptives

```{r}
#Cells
tapply(hypo_moral4$moral.value, 
       list(hypo_moral4$proclamation, hypo_moral4$order, hypo_moral4$moral.time), 
       FUN = mean)
tapply(hypo_moral4$moral.value, 
       list(hypo_moral4$proclamation, hypo_moral4$order, hypo_moral4$moral.time), 
       FUN = sd)
tapply(hypo_moral4$moral.value, 
       list(hypo_moral4$proclamation, hypo_moral4$order, 
            hypo_moral4$moral.time), 
       FUN = length)

#Across Proclamation and Time
tapply(hypo_moral4$moral.value, list(hypo_moral4$proclamation, 
                                     hypo_moral4$moral.time),FUN = length)
tapply(hypo_moral4$moral.value, list(hypo_moral4$proclamation, 
                                     hypo_moral4$moral.time),FUN = mean)
tapply(hypo_moral4$moral.value, list(hypo_moral4$proclamation, 
                                     hypo_moral4$moral.time),FUN = sd)

#Across Order and Time
tapply(hypo_moral4$moral.value, list(hypo_moral4$order, 
                                     hypo_moral4$moral.time),FUN = length)
tapply(hypo_moral4$moral.value, list(hypo_moral4$order, 
                                     hypo_moral4$moral.time),FUN = mean)
tapply(hypo_moral4$moral.value, list(hypo_moral4$order, 
                                     hypo_moral4$moral.time),FUN = sd)

#Across Proclamation and Order
tapply(hypo_moral4$moral.value, list(hypo_moral4$proclamation, 
                                                hypo_moral4$order),FUN = length)
tapply(hypo_moral4$moral.value, list(hypo_moral4$proclamation, 
                                                hypo_moral4$order),FUN = mean)
tapply(hypo_moral4$moral.value, list(hypo_moral4$proclamation, 
                                                hypo_moral4$order),FUN = sd)
#Across Proclamation
tapply(hypo_moral4$moral.value, hypo_moral4$proclamation,FUN = mean)
tapply(hypo_moral4$moral.value, hypo_moral4$proclamation,FUN = sd)
tapply(hypo_moral4$moral.value, hypo_moral4$proclamation,FUN = length)

#Across Order
tapply(hypo_moral4$moral.value, hypo_moral4$order,FUN = mean)
tapply(hypo_moral4$moral.value, hypo_moral4$order,FUN = sd)
tapply(hypo_moral4$moral.value, hypo_moral4$order,FUN = length)

#Across Time
tapply(hypo_moral4$moral.value, hypo_moral4$moral.time,FUN = mean)
tapply(hypo_moral4$moral.value, hypo_moral4$moral.time,FUN = sd)
tapply(hypo_moral4$moral.value, hypo_moral4$moral.time,FUN = length)

#Overall
mean(hypo_moral4$moral.value)
sd(hypo_moral4$moral.value)
length(hypo_moral4$moral.value)
```


# Follow-up tests for two*way interactions: Morality

```{r}
#Proclamation*Time 

#Time 1 vs. 2 on absolute only
#Paired t-test
absolute_s4 <- s4 %>%
  filter(proclamation == "absolute")

t.test(absolute_s4$Moral.1_composite4, absolute_s4$Moral.2_composite4, paired = TRUE)
t_apa(t.test(absolute_s4$Moral.1_composite4, absolute_s4$Moral.2_composite4, paired = TRUE))

#Time 1 vs. 2 on flexible only
#Paired t-test
flexible_s4 <- s4 %>%
  filter(proclamation == "ambiguous")

t.test(flexible_s4$Moral.1_composite4, flexible_s4$Moral.2_composite4, paired = TRUE)
t_apa(t.test(flexible_s4$Moral.1_composite4, flexible_s4$Moral.2_composite4, paired = TRUE))

#Order*Time 

#Time 1 vs. 2 on survey1 only
#Paired t-test
survey1_s4 <- s4 %>%
  filter(order == "survey1")

t.test(survey1_s4$Moral.1_composite4, survey1_s4$Moral.2_composite4, paired = TRUE)
t_apa(t.test(survey1_s4$Moral.1_composite4, survey1_s4$Moral.2_composite4, paired = TRUE))


#Time 1 vs. 2 on game1 only
#Paired t-test
game1_s4 <- s4 %>%
  filter(order == "game1")

t.test(game1_s4$Moral.1_composite4, game1_s4$Moral.2_composite4, paired = TRUE)
t_apa(t.test(game1_s4$Moral.1_composite4, game1_s4$Moral.2_composite4, paired = TRUE))


#Proclamation*Order (linear regressions)

#Effect of order in just absolute targets
absolute_moral <- hypo_moral4 %>%
  filter(proclamation ==  "absolute")

lm_order.moral <- lm(moral.value ~ order, data = absolute_moral)
summary(lm_order.moral)

#Effect of order in just flexible targets
flexible_moral <- hypo_moral4 %>%
  filter(proclamation ==  "ambiguous")

lm_order2.moral <- lm(moral.value ~ order, data = flexible_moral)
summary(lm_order2.moral)

#Effect of proc in just survey1 ordering
survey1_moral <- hypo_moral4  %>%
  filter(order==  "survey1")

lm_order3.hypo <- lm(moral.value ~ proclamation, data = survey1_moral)
summary(lm_order3.hypo )

#Effect of proc in just game1 ordering
game1_moral <- hypo_moral4  %>%
  filter(order==  "game1")

lm_order4.hypo <- lm(moral.value~ proclamation, data = game1_moral)
summary(lm_order4.hypo)

#Alternative ANOVA and tukey post-hoc tests
mor_model = aov_ez('ID', 'moral.value', hypo_moral4,
                    within = c ('moral.time'),
                    between = c ('proclamation', 'order'),
                    anova_table = list(es = 'pes'))
print(mor_model)
ptmeans <- emmeans(mor_model, ~ moral.time|proclamation)
print(ptmeans)
pomeans <- emmeans(mor_model, ~ order|proclamation)
print(pomeans)
tomeans <- emmeans(mor_model, ~ moral.time|order)
print(tomeans)
post1 <- emmeans(mor_model, ~ moral.time|proclamation)
pairs(post1)
post2 <- emmeans(mor_model, ~ order|proclamation)
pairs(post2)  
post3 <- emmeans(mor_model, ~ moral.time|order)
pairs(post3)  
post4 <- emmeans(mor_model, ~ proclamation|order)
pairs(post4)  
```

#Future Honesty

```{r}
#Dataframe for Future Honesty
hypo_honest4 <-melt(s4, 
                   id.vars=c("condition", "ID", "proclamation", "order"),
                   #measure command is for the DV
                   measure.vars=c("Honest_composite4","Honest_composite4.2"),
                   variable.name="honest.time",
                   value.name="honest.value"
)


#ANOVA
honest.afex <- aov_car(honest.value ~ proclamation*order*honest.time + Error(ID/honest.time), data=hypo_honest4)
summary(honest.afex)
anova_apa(honest.afex)
```

#Future Honesty Descriptives

```{r}
#Cells
tapply(hypo_honest4$honest.value, 
       list(hypo_honest4$proclamation, hypo_honest4$order, hypo_honest4$honest.time), 
       FUN = mean)
tapply(hypo_honest4$honest.value, 
       list(hypo_honest4$proclamation, hypo_honest4$order, hypo_honest4$honest.time), 
       FUN = sd)
tapply(hypo_honest4$honest.value, 
       list(hypo_honest4$proclamation, hypo_honest4$order, 
            hypo_honest4$honest.time), 
       FUN = length)

#Across Proclamation and Time
tapply(hypo_honest4$honest.value, list(hypo_honest4$proclamation, 
                                     hypo_honest4$honest.time),FUN = length)
tapply(hypo_honest4$honest.value, list(hypo_honest4$proclamation, 
                                     hypo_honest4$honest.time),FUN = mean)
tapply(hypo_honest4$honest.value, list(hypo_honest4$proclamation, 
                                     hypo_honest4$honest.time),FUN = sd)

#Across Order and Time
tapply(hypo_honest4$honest.value, list(hypo_honest4$order, 
                                     hypo_honest4$honest.time),FUN = length)
tapply(hypo_honest4$honest.value, list(hypo_honest4$order, 
                                     hypo_honest4$honest.time), FUN = mean)
tapply(hypo_honest4$honest.value, list(hypo_honest4$order, 
                                     hypo_honest4$honest.time),FUN = sd)


#Across Proclamation and Order
tapply(hypo_honest4$honest.value, list(hypo_honest4$proclamation, 
                                                hypo_honest4$order),FUN = length)
tapply(hypo_honest4$honest.value, list(hypo_honest4$proclamation, 
                                               hypo_honest4$order),FUN = mean)
tapply(hypo_honest4$honest.value, list(hypo_honest4$proclamation, 
                                               hypo_honest4$order),FUN = sd)

#Across Proclamation
tapply(hypo_honest4$honest.value, hypo_honest4$proclamation,FUN = mean)
tapply(hypo_honest4$honest.value, hypo_honest4$proclamation,FUN = sd)
tapply(hypo_honest4$honest.value, hypo_honest4$proclamation,FUN = length)

#Across Order
tapply(hypo_honest4$honest.value, hypo_honest4$order,FUN = mean)
tapply(hypo_honest4$honest.value, hypo_honest4$order,FUN = sd)
tapply(hypo_honest4$honest.value, hypo_honest4$order,FUN = length)

#Across Time
tapply(hypo_honest4$honest.value, hypo_honest4$honest.time,FUN = mean)
tapply(hypo_honest4$honest.value, hypo_honest4$honest.time,FUN = sd)
tapply(hypo_honest4$honest.value, hypo_honest4$honest.time,FUN = length)

#Overall
mean(hypo_honest4$honest.value)
sd(hypo_honest4$honest.value)
length(hypo_honest4$honest.value)

```

#Follow-up tests for two*way interactions: Future Honesty

```{r}
#Proclamation*Time 

#Time 1 vs. 2 on absolute only
#Paired t-test
absolute_s4 <- s4 %>%
  filter(proclamation == "absolute")

t.test(absolute_s4$Honest_composite4, absolute_s4$Honest_composite4.2, paired = TRUE)
t_apa(t.test(absolute_s4$Honest_composite4, absolute_s4$Honest_composite4.2, paired = TRUE))

#Time 1 vs. 2 on flexible only
#Paired t-test
flexible_s4 <- s4 %>%
  filter(proclamation == "ambiguous")

t.test(flexible_s4$Honest_composite4, flexible_s4$Honest_composite4.2, paired = TRUE)
t_apa(t.test(flexible_s4$Honest_composite4, flexible_s4$Honest_composite4.2, paired = TRUE))

#Order*Time 

#Time 1 vs. 2 on survey1 only
#Paired t-test
survey1_s4 <- s4 %>%
  filter(order == "survey1")

t.test(survey1_s4$Honest_composite4, survey1_s4$Honest_composite4.2, paired = TRUE)
t_apa(t.test(survey1_s4$Honest_composite4, survey1_s4$Honest_composite4.2, paired = TRUE))

#Time 1 vs. 2 on game1 only
#Paired t-test
game1_s4 <- s4 %>%
  filter(order == "game1")

t.test(game1_s4$Honest_composite4, game1_s4$Honest_composite4.2, paired = TRUE)
t_apa(t.test(game1_s4$Honest_composite4, game1_s4$Honest_composite4.2, paired = TRUE))


#Proclamation*Order (linear regressions)

#Effect of order in just absolute
absolute_honest <- hypo_honest4 %>%
  filter(proclamation ==  "absolute")

lm_order.honest <- lm(honest.value ~ order, data = absolute_honest)
summary(lm_order.honest)

flexible_honest <- hypo_honest4 %>%
  filter(proclamation ==  "ambiguous")

lm_order2.honest <- lm(honest.value ~ order, data = flexible_honest)
summary(lm_order2.honest)

#Effect of proc in just survey1
survey1_honest <- hypo_honest4  %>%
  filter(order==  "survey1")

lm_order3.honest <- lm(honest.value ~ proclamation, data = survey1_honest)
summary(lm_order3.honest)

#Effect of proc in just game1
game1_honest <- hypo_honest4  %>%
  filter(order==  "game1")

lm_order4.honest  <- lm(honest.value~ proclamation, data = game1_honest)
summary(lm_order4.honest)

#Alternative ANOVA and tukey post-hoc tests
hon_model = aov_ez('ID', 'honest.value', hypo_honest4,
                    within = c ('honest.time'),
                    between = c ('proclamation', 'order'),
                    anova_table = list(es = 'pes'))
print(hon_model)
ptmeans <- emmeans(hon_model, ~ honest.time|proclamation)
print(ptmeans)
pomeans <- emmeans(hon_model, ~ order|proclamation)
print(pomeans)
tomeans <- emmeans(hon_model, ~ honest.time|order)
print(tomeans)
post1 <- emmeans(hon_model, ~ honest.time|proclamation)
pairs(post1)
post2 <- emmeans(hon_model, ~ order|proclamation)
pairs(post2)  
post3 <- emmeans(hon_model, ~ honest.time|order)
pairs(post3)  
post4 <- emmeans(hon_model, ~ proclamation|order)
pairs(post4) 
```

#Supplemental Information

#Moral Standards Model

```{r}
#Dataframe for Moral Standards (moral_standards1) - "This person has high moral standards"
hypo_ms <-melt(s4, 
                    id.vars=c("condition", "ID", "proclamation", "order"),
                    #measure command is for the DV
                    measure.vars=c("moral_standards1","moral_standards1.2"),
                    variable.name="ms.time",
                    value.name="ms.value"
)


#ANOVA
moralstandards.afex <- aov_car(ms.value ~ proclamation*order*ms.time + Error(ID/ms.time), data= hypo_ms)
summary(moralstandards.afex)
anova_apa(moralstandards.afex)

```

#Moral Standards Descriptives

```{r}
#Cells
tapply(hypo_ms$ms.value , 
       list(hypo_ms$proclamation, hypo_ms$order, hypo_ms$ms.time), 
       FUN = mean)
tapply(hypo_ms$ms.value , 
       list(hypo_ms$proclamation, hypo_ms$order, hypo_ms$ms.time), 
       FUN = sd)
tapply(hypo_ms$ms.value , 
       list(hypo_ms$proclamation, hypo_ms$order, 
            hypo_ms$ms.time), 
       FUN = length)

#Across Proclamation and Time
tapply(hypo_ms$ms.value , list(hypo_ms$proclamation, 
                                     hypo_ms$ms.time),FUN = length)
tapply(hypo_ms$ms.value , list(hypo_ms$proclamation, 
                                     hypo_ms$ms.time),FUN = mean)
tapply(hypo_ms$ms.value , list(hypo_ms$proclamation, 
                                     hypo_ms$ms.time),FUN = sd)

#Across Order and Time
tapply(hypo_ms$ms.value , list(hypo_ms$order, 
                                     hypo_ms$ms.time),FUN = length)
tapply(hypo_ms$ms.value , list(hypo_ms$order, 
                                     hypo_ms$ms.time), FUN = mean)
tapply(hypo_ms$ms.value , list(hypo_ms$order, 
                                     hypo_ms$ms.time),FUN = sd)


#Across Proclamation and Order
tapply(hypo_ms$ms.value , list(hypo_ms$proclamation, 
                                                hypo_ms$order),FUN = length)
tapply(hypo_ms$ms.value , list(hypo_ms$proclamation, 
                                               hypo_ms$order),FUN = mean)
tapply(hypo_ms$ms.value , list(hypo_ms$proclamation, 
                                               hypo_ms$order),FUN = sd)

#Across Proclamation
tapply(hypo_ms$ms.value , hypo_ms$proclamation,FUN = mean)
tapply(hypo_ms$ms.value , hypo_ms$proclamation,FUN = sd)
tapply(hypo_ms$ms.value , hypo_ms$proclamation,FUN = length)

#Across Order
tapply(hypo_ms$ms.value , hypo_ms$order,FUN = mean)
tapply(hypo_ms$ms.value , hypo_ms$order,FUN = sd)
tapply(hypo_ms$ms.value , hypo_ms$order,FUN = length)

#Across Time
tapply(hypo_ms$ms.value , hypo_ms$ms.time,FUN = mean)
tapply(hypo_ms$ms.value , hypo_ms$ms.time,FUN = sd)
tapply(hypo_ms$ms.value , hypo_ms$ms.time,FUN = length)

#Overall
mean(hypo_ms$ms.value)
sd(hypo_ms$ms.value)
length(hypo_ms$ms.value)
```

#Follow-up tests for two*way interactions: Moral Standards

```{r}
#Proclamation*Time 

#Time 1 vs. 2 on absolute only
#Paired t-test
absolute_s4 <- s4 %>%
  filter(proclamation == "absolute")

t.test(absolute_s4$moral_standards1, absolute_s4$moral_standards1.2, paired = TRUE)
t_apa(t.test(absolute_s4$moral_standards1, absolute_s4$moral_standards1.2, paired = TRUE))

#Time 1 vs. 2 on flexible only
#Paired t-test
flexible_s4 <- s4 %>%
  filter(proclamation == "ambiguous")

t.test(flexible_s4$moral_standards1, flexible_s4$moral_standards1.2, paired = TRUE)
t_apa(t.test(flexible_s4$moral_standards1, flexible_s4$moral_standards1.2, paired = TRUE))


#Proclamation*Order (linear regressions)

#Effect of order in just absolute
absolute_ms <- hypo_ms %>%
  filter(proclamation ==  "absolute")

lm_order.ms <- lm(ms.value  ~ order, data = absolute_ms )
summary(lm_order.ms )

#Effect of order in just flexible
flexible_ms <- hypo_ms %>%
  filter(proclamation ==  "ambiguous")

lm_order2.ms  <- lm(ms.value  ~ order, data = flexible_ms)
summary(lm_order2.ms )

#Effect of proc in just survey1
survey1_ms <- hypo_ms  %>%
  filter(order==  "survey1")

lm_order3.ms <- lm(ms.value  ~ proclamation, data = survey1_ms)
summary(lm_order3.ms)

#Effect of proc in just game1
game1_ms <- hypo_ms  %>%
  filter(order==  "game1")

lm_order4.ms <- lm(ms.value ~ proclamation, data = game1_ms)
summary(lm_order4.ms)

#Alternative ANOVA and tukey post-hoc tests
ms_model = aov_ez('ID', 'ms.value', hypo_ms,
                    within = c ('ms.time'),
                    between = c ('proclamation', 'order'),
                    anova_table = list(es = 'pes'))
print(ms_model)
ptmeans <- emmeans(ms_model, ~ ms.time|proclamation)
print(ptmeans)
pomeans <- emmeans(ms_model, ~ order|proclamation)
print(pomeans)
post1 <- emmeans(ms_model, ~ ms.time|proclamation)
pairs(post1)
post2 <- emmeans(ms_model, ~ order|proclamation)
pairs(post2)  
post3 <- emmeans(ms_model, ~ proclamation|order)
pairs(post3) 
```

#Moral Standards - Realism

```{r}
#Dataframe for Realism - "This person is realistic"
hypo_ms2 <-melt(s4, 
                    id.vars=c("condition", "ID", "proclamation", "order"),
                    #measure command is for the DV
                    measure.vars=c("moral_standards2","moral_standards2.2"),
                    variable.name="ms2.time",
                    value.name="ms2.value"
)

#ANOVA
realism.afex <- aov_car(ms2.value ~ proclamation*order*ms2.time + Error(ID/ms2.time), data= hypo_ms2)
summary(realism.afex)
anova_apa(realism.afex)

```

#Realism Descriptive Statistics

```{r}
#Cells
tapply(hypo_ms2$ms2.value, 
       list(hypo_ms2$proclamation, hypo_ms2$order, hypo_ms2$ms2.time), 
       FUN = mean)
tapply(hypo_ms2$ms2.value, 
       list(hypo_ms2$proclamation, hypo_ms2$order, hypo_ms2$ms2.time), 
       FUN = sd)
tapply(hypo_ms2$ms2.value, 
       list(hypo_ms2$proclamation, hypo_ms2$order, 
            hypo_ms2$ms2.time), 
       FUN = length)

#Across Proclamation and Time
tapply(hypo_ms2$ms2.value, list(hypo_ms2$proclamation, 
                                     hypo_ms2$ms2.time),FUN = length)
tapply(hypo_ms2$ms2.value, list(hypo_ms2$proclamation, 
                                     hypo_ms2$ms2.time),FUN = mean)
tapply(hypo_ms2$ms2.value, list(hypo_ms2$proclamation, 
                                     hypo_ms2$ms2.time),FUN = sd)

#Across Order and Time
tapply(hypo_ms2$ms2.value, list(hypo_ms2$order, 
                                     hypo_ms2$ms2.time),FUN = length)
tapply(hypo_ms2$ms2.value, list(hypo_ms2$order, 
                                     hypo_ms2$ms2.time), FUN = mean)
tapply(hypo_ms2$ms2.value, list(hypo_ms2$order, 
                                     hypo_ms2$ms2.time),FUN = sd)


#Across Proclamation and Order
tapply(hypo_ms2$ms2.value, list(hypo_ms2$proclamation, 
                                                hypo_ms2 $order),FUN = length)
tapply(hypo_ms2$ms2.value, list(hypo_ms2$proclamation, 
                                               hypo_ms2$order),FUN = mean)
tapply(hypo_ms2$ms2.value, list(hypo_ms2$proclamation, 
                                               hypo_ms2$order),FUN = sd)

#Across Proclamation
tapply(hypo_ms2$ms2.value, hypo_ms2$proclamation,FUN = mean)
tapply(hypo_ms2$ms2.value, hypo_ms2$proclamation,FUN = sd)
tapply(hypo_ms2$ms2.value, hypo_ms2$proclamation,FUN = length)

#Across Order
tapply(hypo_ms2$ms2.value, hypo_ms2$order,FUN = mean)
tapply(hypo_ms2$ms2.value, hypo_ms2$order,FUN = sd)
tapply(hypo_ms2$ms2.value, hypo_ms2$order,FUN = length)

#Across Time
tapply(hypo_ms2$ms2.value, hypo_ms2$ms2.time,FUN = mean)
tapply(hypo_ms2$ms2.value, hypo_ms2$ms2.time,FUN = sd)
tapply(hypo_ms2$ms2.value, hypo_ms2$ms2.time,FUN = length)

#Overall
mean(hypo_ms2$ms2.value)
sd(hypo_ms2$ms2.value)
length(hypo_ms2$ms2.value)
```

#Follow-up tests for interactions: Realism

```{r}
#Proclamation*Time 

#Time 1 vs. 2 on absolute only
#Paired t-test
absolute_s4 <- s4 %>%
  filter(proclamation == "absolute")

t.test(absolute_s4$moral_standards2, absolute_s4$moral_standards2.2, paired = TRUE)
t_apa(t.test(absolute_s4$moral_standards2, absolute_s4$moral_standards2.2, paired = TRUE))

#Time 1 vs. 2 on flexible only
#Paired t-test
flexible_s4 <- s4 %>%
  filter(proclamation == "ambiguous")

t.test(flexible_s4$moral_standards2, flexible_s4$moral_standards2.2, paired = TRUE)
t_apa(t.test(flexible_s4$moral_standards2, flexible_s4$moral_standards2.2, paired = TRUE))

#Order*Time 

#Time 1 vs. 2 on survey1 only
#Paired t-test
survey1_s4 <- s4 %>%
  filter(order == "survey1")

t.test(survey1_s4$moral_standards2, survey1_s4$moral_standards2.2, paired = TRUE)
t_apa(t.test(survey1_s4$moral_standards2, survey1_s4$moral_standards2.2, paired = TRUE))

#Time 1 vs. 2 on game1 only
#Paired t-test
game1_s4 <- s4 %>%
  filter(order == "game1")

t.test(game1_s4$moral_standards2, game1_s4$moral_standards2.2, paired = TRUE)
t_apa(t.test(game1_s4$moral_standards2, game1_s4$moral_standards2.2, paired = TRUE))


#Proclamation*Order (linear regressions)

#Effect of order in just absolute
absolute_ms2 <- hypo_ms2 %>%
  filter(proclamation ==  "absolute")

lm_order.ms_r <- lm(ms2.value  ~ order, data = absolute_ms2)
summary(lm_order.ms_r)

#Effect of order in just flexible
flexible_ms2 <- hypo_ms2 %>%
  filter(proclamation ==  "ambiguous")

lm_order.ms_r2 <- lm(ms2.value ~ order, data = flexible_ms2)
summary(lm_order.ms_r2)

#Effect of proc in just survey1
survey1_ms2 <- hypo_ms2  %>%
  filter(order==  "survey1")

lm_order.ms_r3 <- lm(ms2.value ~ proclamation, data = survey1_ms2)
summary(lm_order.ms_r3)

#Effect of proc in just game1
game1_ms2 <- hypo_ms2 %>%
  filter(order==  "game1")

lm_order.ms_r4 <- lm(ms2.value ~ proclamation, data = game1_ms2)
summary(lm_order.ms_r4)

#Alternative ANOVA and tukey post-hoc tests
ms2_model = aov_ez('ID', 'ms2.value', hypo_ms2,
                    within = c ('ms2.time'),
                    between = c ('proclamation', 'order'),
                    anova_table = list(es = 'pes'))
print(ms2_model)
ptmeans <- emmeans(ms2_model, ~ ms2.time|proclamation)
print(ptmeans)
pomeans <- emmeans(ms2_model, ~ order|proclamation)
print(pomeans)
post1 <- emmeans(ms2_model, ~ ms2.time|proclamation)
pairs(post1)
post2 <- emmeans(ms2_model, ~ order|proclamation)
pairs(post2)  
post3 <- emmeans(ms2_model, ~ proclamation|order)
pairs(post3) 
```

#Guilt

```{r}
#ANOVA (time two only)
guilt.afex_time <- aov_car(guilt_2.2 ~ proclamation*order + Error(ID), data= s4)
summary(guilt.afex_time)
anova_apa(guilt.afex_time)
```

#Guilt Descriptives for Main Effect of Proclamation

```{r}
#Cells
tapply(s4$guilt_2.2, 
       list(s4$proclamation, s4$order), 
       FUN = mean)
tapply(s4$guilt_2.2, 
       list(s4$proclamation, s4$order), 
       FUN = sd)
tapply(s4$guilt_2.2, 
       list(s4$proclamation, s4$order), 
       FUN = length)

#Across Proclamation
tapply(s4$guilt_2.2, s4$proclamation,FUN = mean)
tapply(s4$guilt_2.2, s4$proclamation,FUN = sd)
tapply(s4$guilt_2.2, s4$proclamation,FUN = length)

#Across Order
tapply(s4$guilt_2.2, s4$order,FUN = mean)
tapply(s4$guilt_2.2, s4$order,FUN = sd)
tapply(s4$guilt_2.2, s4$order,FUN = length)

#Overall
mean(s4$guilt_2.2)
sd(s4$guilt_2.2)
length(s4$guilt_2.2)

```

#Trust Game

```{r}
#Logistic Regression
model.trust_study4 <- glm(trustbeh ~ proclamation*order, data=s4, family = binomial(link = "logit"))
summary(model.trust_study4)
#1 = pass, 0 = keep

chisq.test(s4$proclamation, s4$trustbeh)
table(s4$proclamation,s4$trustbeh)

#percentages who KEEP
table(s4$proclamation, s4$order, s4$trustbeh)

#absolute survey 1 KEEP - 77, 
#ambiguous survey 1 KEEP - 83
#absolute game 1 KEEP - 69
#aambiguous game 1 KEEP - 81
```

See Study4_mediation.R Rscript for mediation results.

